package in.Ashokit.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import in.Ashokit.feign.Coursefeign;
import in.Ashokit.feign.Studentclient;
@Service
public class EnrollmentService {
	 private final Studentclient studentClient;
	    private final Coursefeign courseClient;

	    @Autowired
	    public EnrollmentService(Studentclient studentClient, Coursefeign courseClient) {
	        this.studentClient = studentClient;
	        this.courseClient = courseClient;
	    }
	    
	    
	    public void enrollStudentInCourse(Long studentId, Long courseId) {
	        // Get student and course details
	        Student student = studentClient.getstudent(courseId);
	        Courses course = courseClient.getbyid(courseId);

	        // Check if student and course exist
	        if (student == null || course == null) {
	            throw new IllegalArgumentException("Student or course not found");
	        }

	        // Check if student is already enrolled in the course
	        if (student.getCourses().contains(course)) {
	            throw new IllegalStateException("Student is already enrolled in the course");
	        }

	        // Enroll student in course
	        student.getCourses().add(course);
	        studentClient.updateStudent(student); // Assuming you have a method to update the student in the database
	    }
	    
}
